<section id="websites_summary" class="surface-block">
  <div class="surface-header w-100">
    <div>
      <p class="surface-eyebrow"><%= t("websites.summary.eyebrow") %></p>
      <h1 class="surface-title mb-1"><%= t("websites.summary.title") %></h1>
      <p class="surface-subtitle"><%= t("websites.summary.subtitle") %></p>
    </div>

    <div class="d-flex gap-2 ms-auto flex-wrap justify-content-end">
      <%= link_to t("websites.summary.add_website"), new_website_path, class: "btn add-website-button" %>
    </div>
  </div>

  <% unless current_user.website_count < 1 %>
    <div class="control-grid">
      <%= form_with url: websites_path, method: :get, class: "control-card", local: true do %>
        <div>
          <p class="control-card__eyebrow"><%= t("websites.summary.search") %></p>
          <p class="surface-subtitle mb-2"><%= t("websites.summary.search_placeholder") %></p>
        </div>

        <div class="control-row control-row--search">
          <%= text_field_tag :q, params[:q], class: "form-control", placeholder: t("websites.summary.search_placeholder") %>

          <div class="d-grid">
            <%= submit_tag t("websites.summary.search"), class: "btn search-button" %>
          </div>

          <div class="status-toggle">
            <%= radio_button_tag :status, "healthy", (params[:status].presence || "healthy") == "healthy", id: "status_healthy", class: "btn-check", onchange: "this.form.requestSubmit()" %>
            <label class="status-toggle__pill" for="status_healthy">
              <%= t("websites.list.healthy_status") %>
            </label>

            <%= radio_button_tag :status, "failing", params[:status] == "failing", id: "status_failing", class: "btn-check", onchange: "this.form.requestSubmit()" %>
            <label class="status-toggle__pill" for="status_failing">
              <%= t("websites.list.failing_status") %>
            </label>
          </div>
        </div>
      <% end %>

      <%= form_with url: bulk_create_websites_path, class: "control-card control-card--muted", local: true do %>
        <div class="control-card__header">
          <div>
            <p class="control-card__eyebrow"><%= t("websites.summary.bulk_add") %></p>
            <p class="surface-subtitle mb-2"><%= t("websites.summary.bulk_add_placeholder") %></p>
          </div>
          <%= submit_tag t("websites.summary.bulk_add"), class: "btn add-website-button" %>
        </div>

        <%= text_area_tag :urls, nil, rows: 3, class: "form-control", placeholder: "https://example.com\nhttps://status.example.com" %>
      <% end %>
    </div>
  <% end %>

  <div class="stat-grid">
    <div class="stat-card stat-card--center">
      <span class="stat-card__label"><%= t("websites.summary.total_websites_label") %></span>
      <span class="stat-card__value"><%= current_user.website_count %></span>
      <p class="mb-0 surface-subtitle"><%= t("websites.summary.total_websites_subtitle") %></p>
    </div>

    <%= link_to failures_websites_path, class: "stat-card stat-card--alert stat-card--link stat-card--center" do %>
      <span class="stat-card__label"><%= t("websites.summary.todays_failures_label") %></span>
      <span class="stat-card__value"><%= @failed_websites_count.to_i %></span>
      <span class="badge"><%= t("websites.summary.view_failure_log") %></span>
    <% end %>
  </div>
</section>

