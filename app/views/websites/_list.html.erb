<section class="surface-block mt-4">
  <div class="row g-4">
    <% if websites.blank? %>
      <div class="col-12">
        <p class="surface-subtitle mb-0 text-nowrap">
          <%= params[:status] == "failing" ? t("websites.failures.all_clear_subtitle") : t("websites.list.none_found") %>
        </p>
      </div>
    <% else %>
      <% websites.each do |website| %>
        <div class="col-md-6 col-lg-4">
          <% failed = website.failed_responses_since_midnight? %>
          <div class="card site-card h-100 <%= 'failed' if failed %>">
            <div class="card-body">
              <div class="d-flex align-items-start justify-content-between">
                <h5 class="card-title mb-0 flex-grow-1">
                  <%= link_to website.url, website_path(website), class: "stretched-link" %>
                </h5>
                <% if website.responses.any? %>
                  <span class="status-chip <%= failed ? 'status-chip--alert' : 'status-chip--ok' %>">
                    <%= failed ? t("websites.list.attention") : t("websites.list.stable") %>
                  </span>
                <% end %>
              </div>

              <div class="site-card__meta">
                <span><strong><%= t("websites.list.responses") %></strong> <%= website.responses.count %></span>
                <% if website.responses.any? %>
                  <span class="site-card__timestamp">
                    <%= t("websites.list.last_status", code: website.latest_response.status_code) %> Â·
                    <%= website.latest_response.created_at.in_time_zone("Eastern Time (US & Canada)").strftime("%b %d, %Y %l:%M %p") %>
                  </span>
                <% else %>
                  <span class="site-card__timestamp"><%= t("websites.list.awaiting_first") %></span>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="d-flex justify-content-center mt-4">
    <%= paginate websites, params: { failed: params[:failed], q: params[:q], status: params[:status] } %>
  </div>
</section>