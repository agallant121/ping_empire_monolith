<% content_for :body_class, "admin-aws-settings" %>

<div class="container-sm">
  <div class="card shadow-sm">
    <div class="card-body">
      <h1 class="h4 mb-3"><%= t("admin.aws_settings.heading") %></h1>
      <p class="text-muted"><%= t("admin.aws_settings.subheading") %></p>

      <%= form_with model: [:admin, @aws_setting], url: admin_aws_settings_path, method: (@aws_setting.persisted? ? :patch : :post), class: "vstack gap-3" do |form| %>
        <div>
          <%= form.label :access_key_id, class: "form-label" %>
          <%= form.text_field :access_key_id, class: "form-control", autocomplete: "off", required: true %>
        </div>

        <div>
          <%= form.label :secret_access_key, class: "form-label" %>
          <%= form.password_field :secret_access_key, class: "form-control", autocomplete: "off", required: true %>
        </div>

        <div>
          <%= form.label :session_token, class: "form-label" %>
          <%= form.text_field :session_token, class: "form-control", autocomplete: "off" %>
          <div class="form-text"><%= t("admin.aws_settings.session_token_optional") %></div>
        </div>

        <div>
          <%= form.label :region, class: "form-label" %>
          <%= form.text_field :region, class: "form-control", placeholder: t("admin.aws_settings.region_placeholder", default: "us-east-1"), required: true %>
        </div>

        <div>
          <%= form.label :bucket, class: "form-label" %>
          <%= form.text_field :bucket, class: "form-control", required: true %>
        </div>

        <div>
          <%= form.label :key_prefix, class: "form-label" %>
          <%= form.text_field :key_prefix, class: "form-control", placeholder: t("admin.aws_settings.key_prefix_placeholder", default: "archives/optional-folder") %>
          <div class="form-text"><%= t("admin.aws_settings.key_prefix_optional") %></div>
        </div>

        <% if @aws_setting.errors.any? %>
          <div class="alert alert-danger">
            <p class="mb-2"><%= t("admin.aws_settings.fix_errors") %></p>
            <ul class="mb-0">
              <% @aws_setting.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="d-flex align-items-center gap-3">
          <%= form.submit(@aws_setting.persisted? ? t("admin.aws_settings.update") : t("admin.aws_settings.save"), class: "btn btn-primary") %>
          <%= link_to t("admin.aws_settings.back_to_archives"), admin_archives_path, class: "btn btn-link" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
